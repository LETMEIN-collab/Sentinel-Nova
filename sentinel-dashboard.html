<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>SENTINEL — Global Risk &amp; Security Terminal</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap');
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',sans-serif;background:#000;color:#d4d4d4;overflow-x:hidden;font-size:12px}
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:#000}::-webkit-scrollbar-thumb{background:#333;border-radius:2px}
:root{--bg0:#000;--bg1:#0a0a0a;--bg2:#111;--bg3:#1a1a1a;--bdr:#222;--bdrh:#333;--amber:#ff9500;--amberd:#b36800;--amberbg:rgba(255,149,0,0.08);--red:#ff3b30;--redbg:rgba(255,59,48,0.1);--grn:#30d158;--grnbg:rgba(48,209,88,0.08);--blu:#0a84ff;--cyan:#64d2ff;--pur:#bf5af2;--yel:#ffd60a;--t1:#e5e5e5;--t2:#999;--t3:#666;--mono:'JetBrains Mono',monospace}

/* TICKER */
.ticker{background:#050505;border-bottom:1px solid var(--bdr);height:24px;overflow:hidden;display:flex;align-items:center}
.tscroll{display:flex;animation:tsc 60s linear infinite;white-space:nowrap}.tscroll:hover{animation-play-state:paused}
@keyframes tsc{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}
.tk{display:inline-flex;align-items:center;gap:5px;margin-right:28px;font:500 11px var(--mono);letter-spacing:.3px}
.tk .s{color:var(--amber)}.tk .p{color:var(--t1)}.tk .up{color:var(--grn);font-size:10px}.tk .dn{color:var(--red);font-size:10px}
.tsep{color:var(--bdr);margin-right:28px}

/* HEADER */
.hdr{background:var(--bg1);border-bottom:1px solid var(--bdr);padding:8px 16px;display:flex;align-items:center;justify-content:space-between}
.hdr-l{display:flex;align-items:center;gap:12px}
.logo{font:700 14px var(--mono);color:var(--amber);letter-spacing:2px}
.logo span{color:var(--t3);font-weight:400;font-size:10px;letter-spacing:1px;margin-left:8px}
.hdr-r{display:flex;align-items:center;gap:20px;font:400 11px var(--mono);color:var(--t3)}
.live{display:flex;align-items:center;gap:5px}
.ldot{width:6px;height:6px;background:var(--grn);border-radius:50%;animation:bl 2s infinite}
@keyframes bl{0%,100%{opacity:1}50%{opacity:.3}}
.threat{padding:3px 10px;border-radius:3px;font:600 10px var(--mono);letter-spacing:1px;text-transform:uppercase;background:var(--redbg);color:var(--red);border:1px solid rgba(255,59,48,.3)}

/* LAYOUT */
.shell{display:grid;grid-template-columns:240px 1fr 280px;height:calc(100vh - 79px);overflow:hidden}
.sidebar{background:var(--bg1);border-right:1px solid var(--bdr);overflow-y:auto}
.center{display:flex;flex-direction:column;overflow:hidden}
.rpanel{background:var(--bg1);border-left:1px solid var(--bdr);overflow-y:auto}

/* PANELS */
.ph{display:flex;align-items:center;justify-content:space-between;padding:8px 12px;background:var(--bg2);border-bottom:1px solid var(--bdr);position:sticky;top:0;z-index:2}
.pt{font:600 10px var(--mono);text-transform:uppercase;letter-spacing:1.5px;color:var(--amber);display:flex;align-items:center;gap:6px}
.pb{font:500 9px var(--mono);padding:1px 6px;border-radius:2px;letter-spacing:.5px}
.pbd{padding:10px 12px}

/* RISK GAUGES */
.rg{margin-bottom:10px;padding-bottom:10px;border-bottom:1px solid var(--bdr)}.rg:last-child{border-bottom:none;margin-bottom:0;padding-bottom:0}
.rg-t{display:flex;justify-content:space-between;align-items:baseline;margin-bottom:5px}
.rg-l{font:500 11px/1 'Inter',sans-serif;color:var(--t2)}
.rg-v{font:700 16px var(--mono)}
.rg-b{height:4px;background:var(--bg3);border-radius:2px;overflow:hidden;margin-bottom:3px}
.rg-f{height:100%;border-radius:2px;transition:width 1s ease}
.rg-m{font:400 9px var(--mono);color:var(--t3);display:flex;justify-content:space-between}

/* MAP */
.mwrap{position:relative;width:100%;height:100%;min-height:300px;background:var(--bg0)}
.mwrap svg{width:100%;height:100%}
.mfilt{position:absolute;top:8px;left:8px;display:flex;gap:4px;flex-wrap:wrap}
.mfb{font:500 9px var(--mono);padding:3px 8px;border-radius:2px;border:1px solid var(--bdr);background:var(--bg2);color:var(--t3);cursor:pointer;transition:all .15s;text-transform:uppercase;letter-spacing:.5px}
.mfb:hover{border-color:var(--bdrh);color:var(--t2)}.mfb.a{background:var(--amberbg);border-color:var(--amberd);color:var(--amber)}
.mstat{position:absolute;top:8px;right:8px;display:flex;gap:6px}
.ms{background:rgba(0,0,0,.8);border:1px solid var(--bdr);border-radius:3px;padding:4px 8px;text-align:center}
.msv{font:700 14px var(--mono);display:block}.msl{font:400 8px var(--mono);color:var(--t3);text-transform:uppercase;letter-spacing:.5px}
.mleg{position:absolute;bottom:8px;left:8px;display:flex;gap:10px;font:400 9px var(--mono);color:var(--t3)}
.ml{display:flex;align-items:center;gap:3px}.mld{width:6px;height:6px;border-radius:50%}
.mpulse{animation:mp 2s infinite}@keyframes mp{0%{r:5;opacity:.9}50%{r:14;opacity:0}100%{r:5;opacity:0}}

/* CONNECTION LINES */
.conn-line{stroke-dasharray:4,3;animation:dash 20s linear infinite}
@keyframes dash{0%{stroke-dashoffset:0}100%{stroke-dashoffset:-200}}

/* NEWS TICKER */
.newstick{background:#050505;border-top:1px solid var(--bdr);height:22px;overflow:hidden;display:flex;align-items:center}
.newstick .label{font:600 9px var(--mono);color:var(--red);padding:0 10px;text-transform:uppercase;letter-spacing:1px;white-space:nowrap;border-right:1px solid var(--bdr);flex-shrink:0}
.nscroll{display:flex;animation:nsc 90s linear infinite;white-space:nowrap}.nscroll:hover{animation-play-state:paused}
@keyframes nsc{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}
.nitem{display:inline-flex;align-items:center;gap:6px;margin-right:40px;font:400 10px 'Inter',sans-serif;color:var(--t2)}
.nitem .ndot{width:4px;height:4px;border-radius:50%;flex-shrink:0}
.nitem .nsrc{font:400 9px var(--mono);color:var(--t3);margin-left:4px}

/* HEADER SPARKLINE */
.hdr-spgi{display:flex;align-items:center;gap:8px;padding:2px 10px;background:var(--bg2);border:1px solid var(--bdr);border-radius:3px}

/* INTEL FEED */
.fi{padding:8px 0;border-bottom:1px solid var(--bdr)}.fi:last-child{border-bottom:none}
.fi:hover{background:var(--bg2);margin:0 -12px;padding:8px 12px}
.fit{display:flex;align-items:center;gap:6px;margin-bottom:3px}
.fis{width:6px;height:6px;border-radius:50%;flex-shrink:0}
.fitg{font:500 8px var(--mono);padding:1px 5px;border-radius:2px;text-transform:uppercase;letter-spacing:.5px}
.fitm{font:400 9px var(--mono);color:var(--t3);margin-left:auto}
.fitt{font:500 11px/1.4 'Inter',sans-serif;color:var(--t1)}
.fisu{font:400 10px 'Inter',sans-serif;color:var(--t3);margin-top:2px}

/* MARKET */
.mr{display:flex;justify-content:space-between;align-items:center;padding:6px 0;border-bottom:1px solid rgba(34,34,34,.5);font:400 11px var(--mono)}
.mr:last-child{border-bottom:none}
.mrs{color:var(--t1);font-weight:500;width:65px}.mrp{color:var(--t1);width:65px;text-align:right}.mrc{width:60px;text-align:right;font-size:10px}
.msec{padding:6px 12px;font:600 9px var(--mono);color:var(--amberd);letter-spacing:1.5px;text-transform:uppercase;background:var(--bg2);border-bottom:1px solid var(--bdr);position:sticky;top:0;z-index:1}

/* CHART TABS */
.ctabs{display:flex;gap:4px;margin-bottom:8px}
.ct{font:500 9px var(--mono);padding:3px 8px;border-radius:2px;border:1px solid var(--bdr);background:transparent;color:var(--t3);cursor:pointer;letter-spacing:.5px;transition:all .15s}
.ct.a{background:var(--amberbg);border-color:var(--amberd);color:var(--amber)}.ct:hover{border-color:var(--bdrh)}

/* TOOLTIP */
.tt{position:fixed;background:var(--bg2);border:1px solid var(--bdrh);border-radius:4px;padding:8px 12px;z-index:200;pointer-events:none;max-width:280px;box-shadow:0 4px 20px rgba(0,0,0,.6)}
.tt h5{font:600 11px 'Inter',sans-serif;margin-bottom:3px}.tt p{font:400 10px 'Inter',sans-serif;color:var(--t2);line-height:1.4}

/* REGIONAL */
.rr{display:flex;justify-content:space-between;align-items:center;padding:5px 0;border-bottom:1px solid var(--bdr);font:400 10px var(--mono)}
.rr:last-child{border-bottom:none}
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const {useState,useEffect,useRef,useMemo}=React;

/* ═══ MINI SVG CHART COMPONENTS ═══ */
const Sparkline=({data,dataKey,w=200,h=60,color='#30d158',fill=true,showAxis=false})=>{
  const vals=data.map(d=>d[dataKey]);
  const mn=Math.min(...vals),mx=Math.max(...vals);
  const range=mx-mn||1;
  const pad=4;
  const pts=vals.map((v,i)=>{
    const x=pad+(i/(vals.length-1))*(w-pad*2);
    const y=pad+((mx-v)/range)*(h-pad*2);
    return `${x},${y}`;
  });
  const line=pts.join(' ');
  const areaPath=`M${pts[0]} L${line.replace(/,/g,' ').split(' L').join(' L')} L${pad+(vals.length-1)/(vals.length-1)*(w-pad*2)},${h} L${pad},${h} Z`;
  const polyline=pts.join(' ');
  const gradId='g'+Math.random().toString(36).slice(2,8);
  return(
    <svg width="100%" height={h} viewBox={`0 0 ${w} ${h}`} preserveAspectRatio="none">
      {fill&&<defs><linearGradient id={gradId} x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stopColor={color} stopOpacity=".25"/><stop offset="100%" stopColor={color} stopOpacity="0"/></linearGradient></defs>}
      {fill&&<polygon points={`${pts[0]} ${polyline} ${pad+(vals.length-1)/(vals.length-1)*(w-pad*2)},${h-pad} ${pad},${h-pad}`} fill={`url(#${gradId})`}/>}
      <polyline points={polyline} fill="none" stroke={color} strokeWidth="1.5" strokeLinejoin="round" strokeLinecap="round"/>
    </svg>
  );
};

const AreaChartSVG=({data,keys,colors,w=400,h=180,labels})=>{
  const allVals=keys.flatMap(k=>data.map(d=>d[k]));
  const mx=Math.max(...allVals),mn=0;
  const range=mx-mn||1;
  const pad={t:10,r:10,b:24,l:32};
  const cw=w-pad.l-pad.r,ch=h-pad.t-pad.b;
  const toX=i=>pad.l+(i/(data.length-1))*cw;
  const toY=v=>pad.t+((mx-v)/range)*ch;
  return(
    <svg width="100%" viewBox={`0 0 ${w} ${h}`} style={{display:'block'}}>
      {/* grid */}
      {[0,.25,.5,.75,1].map((f,i)=>{
        const y=pad.t+f*ch;
        const v=Math.round(mx-(f*range));
        return <g key={i}><line x1={pad.l} y1={y} x2={w-pad.r} y2={y} stroke="#1a1a1a" strokeWidth=".5"/><text x={pad.l-4} y={y+3} fill="#666" fontSize="8" fontFamily="JetBrains Mono" textAnchor="end">{v}</text></g>;
      })}
      {/* x labels */}
      {data.map((d,i)=><text key={i} x={toX(i)} y={h-4} fill="#666" fontSize="8" fontFamily="JetBrains Mono" textAnchor="middle">{d.d||d.month||''}</text>)}
      {/* areas + lines */}
      {keys.map((k,ki)=>{
        const pts=data.map((d,i)=>`${toX(i)},${toY(d[k])}`).join(' ');
        const gid='ac'+ki+Math.random().toString(36).slice(2,6);
        return <g key={k}>
          <defs><linearGradient id={gid} x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stopColor={colors[ki]} stopOpacity=".15"/><stop offset="100%" stopColor={colors[ki]} stopOpacity="0"/></linearGradient></defs>
          <polygon points={`${toX(0)},${toY(0)} ${pts} ${toX(data.length-1)},${toY(0)}`} fill={`url(#${gid})`}/>
          <polyline points={pts} fill="none" stroke={colors[ki]} strokeWidth="1.5" strokeLinejoin="round"/>
        </g>;
      })}
    </svg>
  );
};

/* ═══ DATA ═══ */
const TICKERS=[
  {s:'SPGI',p:'512.38',c:'+1.24%',u:true},{s:'ES1',p:'5,842',c:'+0.32%',u:true},{s:'NQ1',p:'20,815',c:'+0.48%',u:true},
  {s:'DXY',p:'104.12',c:'-0.18%',u:false},{s:'GC1',p:'2,938',c:'+0.85%',u:true},{s:'CL1',p:'78.62',c:'-1.23%',u:false},
  {s:'US10Y',p:'4.284',c:'+2bp',u:false},{s:'VIX',p:'16.82',c:'-3.41%',u:false},{s:'BTC',p:'97,245',c:'+2.14%',u:true},
  {s:'EUR',p:'1.0842',c:'+0.11%',u:true},{s:'GBP',p:'1.2668',c:'-0.07%',u:false},{s:'JPY',p:'152.34',c:'+0.23%',u:true},
  {s:'NG1',p:'3.42',c:'+4.12%',u:true},{s:'HG1',p:'4.28',c:'-0.56%',u:false},{s:'W1',p:'582.50',c:'+1.87%',u:true},
];

const RISKS=[
  {id:'geo',l:'Geopolitical Risk',v:78,c:'var(--red)',d:'+4.2',dir:'up',st:'ELEVATED'},
  {id:'clim',l:'Climate Security',v:72,c:'var(--amber)',d:'+6.8',dir:'up',st:'HIGH'},
  {id:'cyb',l:'Cyber Threat',v:65,c:'var(--pur)',d:'+2.1',dir:'up',st:'HIGH'},
  {id:'econ',l:'Economic Stability',v:41,c:'var(--blu)',d:'-3.5',dir:'dn',st:'MODERATE'},
  {id:'con',l:'Armed Conflict',v:83,c:'var(--red)',d:'+7.9',dir:'up',st:'CRITICAL'},
  {id:'sup',l:'Supply Chain',v:58,c:'var(--cyan)',d:'+1.2',dir:'up',st:'ELEVATED'},
  {id:'ene',l:'Energy Security',v:67,c:'var(--yel)',d:'+5.4',dir:'up',st:'HIGH'},
  {id:'pan',l:'Health/Pandemic',v:29,c:'var(--grn)',d:'-8.1',dir:'dn',st:'LOW'},
];

const INCIDENTS=[
  {id:1,t:'Russian Naval Buildup in Black Sea — NATO Alert Level Raised',sv:'critical',cat:'CONFLICT',reg:'E. Europe',tm:'12m',lat:44,lon:34,imp:'NATO Article 5 consultation triggered',ty:'Military'},
  {id:2,t:'Cat-5 Cyclone Bearing Down on Bay of Bengal — 2.4M at Risk',sv:'critical',cat:'CLIMATE',reg:'S. Asia',tm:'28m',lat:16,lon:87,imp:'$8.2B estimated damage',ty:'Weather'},
  {id:3,t:'Major Ransomware Attack on European Energy Grid Operator',sv:'critical',cat:'CYBER',reg:'W. Europe',tm:'1h',lat:50,lon:8,imp:'3 nations, grid at 60%',ty:'Cyber'},
  {id:4,t:'Taiwan Strait — PLA Air Incursions Reach 52 Sorties in 24h',sv:'critical',cat:'CONFLICT',reg:'E. Asia',tm:'2h',lat:24,lon:121,imp:'Semiconductor supply risk',ty:'Military'},
  {id:5,t:'Strait of Hormuz — Tanker Seized by IRGC Navy',sv:'critical',cat:'ENERGY',reg:'M. East',tm:'3h',lat:26.5,lon:56,imp:'Oil +4.2%, $2.1B/day trade risk',ty:'Maritime'},
  {id:6,t:'Sahel Region — Wagner Group Expands Into 3 New Countries',sv:'high',cat:'CONFLICT',reg:'W. Africa',tm:'4h',lat:14,lon:-2,imp:'Democratic transitions destabilized',ty:'Military'},
  {id:7,t:'Mediterranean Wildfire Season — 340K Ha Across 5 Nations',sv:'high',cat:'CLIMATE',reg:'S. Europe',tm:'5h',lat:38,lon:23,imp:'$3.1B economic impact',ty:'Wildfire'},
  {id:8,t:'North Korea ICBM Test — Trajectory Over Sea of Japan',sv:'critical',cat:'CONFLICT',reg:'E. Asia',tm:'6h',lat:39,lon:127,imp:'UN emergency session called',ty:'WMD'},
  {id:9,t:'Amazon Deforestation Surge — 40% Above 5-Year Average',sv:'high',cat:'CLIMATE',reg:'S. America',tm:'6h',lat:-5,lon:-60,imp:'Carbon sink -12%',ty:'Deforestation'},
  {id:10,t:'US-China Semiconductor Export Controls Expanded',sv:'high',cat:'ECONOMIC',reg:'Global',tm:'8h',lat:39,lon:-77,imp:'$45B bilateral trade affected',ty:'Trade'},
  {id:11,t:'Arctic Permafrost Methane Release Exceeds Models by 40%',sv:'high',cat:'CLIMATE',reg:'Arctic',tm:'10h',lat:72,lon:125,imp:'Tipping point risk elevated',ty:'Emissions'},
  {id:12,t:'Sudan Civil Conflict — 2M New Displacements',sv:'high',cat:'CONFLICT',reg:'E. Africa',tm:'12h',lat:15,lon:32,imp:'Humanitarian crisis, spillover',ty:'Civil War'},
  {id:13,t:'EU Carbon Border Tax Phase 2 — 8 Sectors Added',sv:'medium',cat:'REGULATORY',reg:'Europe',tm:'1d',lat:50,lon:4,imp:'€45B cross-border trade',ty:'Regulatory'},
  {id:14,t:'India-Pakistan Indus Treaty Renegotiation Stalls',sv:'high',cat:'CONFLICT',reg:'S. Asia',tm:'1d',lat:30,lon:72,imp:'300M affected, agriculture risk',ty:'Water'},
  {id:15,t:'Pacific Islands Climate Emergency — Sea Level +18cm',sv:'high',cat:'CLIMATE',reg:'Oceania',tm:'1d',lat:-8,lon:160,imp:'$420M relocation costs',ty:'Sea Level'},
  {id:16,t:'Venezuelan Migration Crisis — 800K Cross to Colombia',sv:'medium',cat:'SOCIAL',reg:'S. America',tm:'1d',lat:7,lon:-72,imp:'$1.2B aid needed',ty:'Migration'},
  {id:17,t:'Chinese Spy Balloon Incursions — 3 Nations Report',sv:'medium',cat:'INTEL',reg:'Global',tm:'2d',lat:45,lon:-100,imp:'Sovereignty concern',ty:'Espionage'},
  {id:18,t:'Gulf of Guinea Piracy — 12 Incidents in 30 Days',sv:'medium',cat:'MARITIME',reg:'W. Africa',tm:'2d',lat:4,lon:3,imp:'$800M insurance spike',ty:'Maritime'},
];

const CC={CONFLICT:'#ff3b30',CLIMATE:'#ff9500',CYBER:'#bf5af2',ECONOMIC:'#0a84ff',ENERGY:'#ffd60a',REGULATORY:'#64d2ff',SOCIAL:'#30d158',INTEL:'#ff375f',MARITIME:'#5ac8fa'};
const SC={critical:'#ff3b30',high:'#ff9500',medium:'#ffd60a',low:'#30d158'};

/* Connection lines between related incidents [fromId, toId, label, color] */
const CONNS=[
  [5,1,'Energy supply chain disruption','#ffd60a'],   // Hormuz → Black Sea
  [4,8,'East Asia escalation corridor','#ff3b30'],     // Taiwan → DPRK
  [1,3,'Hybrid warfare vector','#bf5af2'],             // Black Sea → Cyber EU
  [10,4,'Trade decoupling','#0a84ff'],                 // US-China → Taiwan
  [5,14,'Water-energy nexus','#64d2ff'],               // Hormuz → Indus
  [6,12,'Sahel-Sudan conflict arc','#ff3b30'],         // Sahel → Sudan
];

/* News headlines for live ticker */
const NEWS=[
  {t:'NATO deploys additional carrier group to Eastern Mediterranean amid rising tensions',s:'Reuters',c:'#ff3b30'},
  {t:'Global reinsurance rates surge 18% on back of record climate losses',s:'FT',c:'#ff9500'},
  {t:'CISA warns of critical infrastructure vulnerability in energy sector SCADA systems',s:'CyberScoop',c:'#bf5af2'},
  {t:'World Bank revises global GDP growth forecast down to 2.4% citing geopolitical risk',s:'Bloomberg',c:'#0a84ff'},
  {t:'China conducts live-fire naval exercises in South China Sea for third consecutive week',s:'SCMP',c:'#ff3b30'},
  {t:'European gas storage levels fall below 5-year average ahead of winter season',s:'Platts',c:'#ffd60a'},
  {t:'UN Security Council emergency session on Sahel security deterioration',s:'AP',c:'#ff3b30'},
  {t:'IMF warns sovereign debt risks compounding climate vulnerability in 40 nations',s:'FT',c:'#ff9500'},
  {t:'US Treasury sanctions 12 entities linked to ransomware-as-a-service operations',s:'WSJ',c:'#bf5af2'},
  {t:'Arctic shipping routes see 300% increase in commercial traffic year-over-year',s:'Reuters',c:'#64d2ff'},
  {t:'OPEC+ signals potential output cut extension as demand outlook weakens',s:'Bloomberg',c:'#ffd60a'},
  {t:'S&P Global upgrades defense sector outlook to positive on sustained spending growth',s:'S&P Global',c:'#30d158'},
];

const MKTS={
  'US INDICES':[{s:'SPX',n:'S&P 500',p:'5,842.50',c:'+0.32%',u:1},{s:'NDX',n:'Nasdaq 100',p:'20,815',c:'+0.48%',u:1},{s:'DJI',n:'Dow Jones',p:'43,248',c:'+0.15%',u:1},{s:'RUT',n:'Russell 2K',p:'2,058',c:'-0.41%',u:0}],
  'GLOBAL':[{s:'UKX',n:'FTSE 100',p:'8,412',c:'+0.22%',u:1},{s:'DAX',n:'DAX 40',p:'19,845',c:'+0.34%',u:1},{s:'NKY',n:'Nikkei',p:'38,920',c:'-0.58%',u:0},{s:'SHCOMP',n:'Shanghai',p:'3,084',c:'-1.12%',u:0},{s:'SENSEX',n:'Sensex',p:'72,410',c:'+0.67%',u:1}],
  'COMMODITIES':[{s:'GC1',n:'Gold',p:'2,938',c:'+0.85%',u:1},{s:'CL1',n:'WTI Crude',p:'78.62',c:'-1.23%',u:0},{s:'NG1',n:'Nat Gas',p:'3.42',c:'+4.12%',u:1},{s:'HG1',n:'Copper',p:'4.28',c:'-0.56%',u:0},{s:'W1',n:'Wheat',p:'582.50',c:'+1.87%',u:1}],
  'FX & RATES':[{s:'DXY',n:'Dollar Idx',p:'104.12',c:'-0.18%',u:0},{s:'EUR',n:'EUR/USD',p:'1.0842',c:'+0.11%',u:1},{s:'US10Y',n:'10Y Yield',p:'4.284%',c:'+2bp',u:0},{s:'US2Y',n:'2Y Yield',p:'4.612%',c:'+1bp',u:0}],
  'CRYPTO':[{s:'BTC',n:'Bitcoin',p:'97,245',c:'+2.14%',u:1},{s:'ETH',n:'Ethereum',p:'3,284',c:'+1.56%',u:1}],
  'DEFENSE & INTEL':[{s:'SPGI',n:'S&P Global',p:'512.38',c:'+1.24%',u:1},{s:'LMT',n:'Lockheed',p:'458.92',c:'+2.34%',u:1},{s:'RTX',n:'RTX Corp',p:'98.45',c:'+1.82%',u:1},{s:'NOC',n:'Northrop',p:'512.10',c:'+1.45%',u:1},{s:'PLTR',n:'Palantir',p:'78.22',c:'+3.21%',u:1}],
};

const TREND={
  '1M':[{d:'W1',geo:72,clim:65,cyb:61,con:74},{d:'W2',geo:74,clim:67,cyb:63,con:76},{d:'W3',geo:75,clim:69,cyb:62,con:79},{d:'W4',geo:78,clim:72,cyb:65,con:83}],
  '6M':[{d:'Sep',geo:68,clim:58,cyb:55,con:65},{d:'Oct',geo:70,clim:62,cyb:58,con:70},{d:'Nov',geo:72,clim:64,cyb:60,con:73},{d:'Dec',geo:74,clim:66,cyb:62,con:76},{d:'Jan',geo:76,clim:70,cyb:64,con:80},{d:'Feb',geo:78,clim:72,cyb:65,con:83}],
  '1Y':[{d:'Mar',geo:60,clim:48,cyb:50,con:55},{d:'May',geo:62,clim:52,cyb:52,con:58},{d:'Jul',geo:65,clim:55,cyb:54,con:62},{d:'Sep',geo:68,clim:58,cyb:55,con:65},{d:'Nov',geo:72,clim:64,cyb:60,con:73},{d:'Feb',geo:78,clim:72,cyb:65,con:83}],
};

const SPGI=[{t:'09:30',p:508.2},{t:'10:00',p:509.5},{t:'10:30',p:510.1},{t:'11:00',p:509.8},{t:'11:30',p:511.2},{t:'12:00',p:510.6},{t:'12:30',p:511.8},{t:'13:00',p:512.5},{t:'13:30',p:511.9},{t:'14:00',p:512.8},{t:'14:30',p:513.1},{t:'15:00',p:512.4},{t:'15:30',p:512.0},{t:'16:00',p:512.38}];

const REGS=[
  {r:'Middle East',v:89,n:24,d:'+12%'},{r:'Eastern Europe',v:84,n:18,d:'+8%'},{r:'East Asia',v:76,n:15,d:'+5%'},
  {r:'Sub-Saharan Africa',v:74,n:22,d:'+11%'},{r:'South Asia',v:68,n:14,d:'+4%'},{r:'Latin America',v:52,n:9,d:'+2%'},
  {r:'Western Europe',v:38,n:6,d:'+7%'},{r:'North America',v:32,n:4,d:'+1%'},
];

/* ═══ APP ═══ */
function App(){
  const[time,setTime]=useState(new Date());
  const[mf,setMf]=useState('ALL');
  const[tt,setTt]=useState(null);
  const[tp,setTp]=useState('6M');

  useEffect(()=>{const i=setInterval(()=>setTime(new Date()),1000);return()=>clearInterval(i)},[]);

  const proj=(lat,lon)=>[(lon+180)*(960/360),(90-lat)*(480/180)];
  const fi=mf==='ALL'?INCIDENTS:INCIDENTS.filter(i=>i.cat===mf);

  return(
    <div>
      {/* Ticker */}
      <div className="ticker"><div className="tscroll">
        {[...TICKERS,...TICKERS].map((t,i)=><React.Fragment key={i}>
          <span className="tk"><span className="s">{t.s}</span><span className="p">{t.p}</span><span className={t.u?'up':'dn'}>{t.c}</span></span>
          {i%5===4&&<span className="tsep">│</span>}
        </React.Fragment>)}
      </div></div>

      {/* Header */}
      <div className="hdr">
        <div className="hdr-l"><div className="logo">SENTINEL<span>GLOBAL RISK & SECURITY TERMINAL</span></div></div>
        <div className="hdr-r">
          <div className="hdr-spgi">
            <span style={{font:'600 10px var(--mono)',color:'var(--amber)'}}>SPGI</span>
            <span style={{font:'700 11px var(--mono)',color:'var(--grn)'}}>512.38</span>
            <svg width="48" height="16" viewBox="0 0 48 16"><polyline points={SPGI.map((d,i)=>{const x=i/(SPGI.length-1)*48;const mn=Math.min(...SPGI.map(s=>s.p));const mx=Math.max(...SPGI.map(s=>s.p));return `${x},${2+((mx-d.p)/(mx-mn))*12}`}).join(' ')} fill="none" stroke="#30d158" strokeWidth="1.2"/></svg>
            <span style={{font:'500 9px var(--mono)',color:'var(--grn)'}}>+1.24%</span>
          </div>
          <span className="threat">⚠ THREAT LEVEL: ELEVATED</span>
          <span className="live"><span className="ldot"></span>LIVE</span>
          <span>{time.toLocaleString('en-US',{month:'short',day:'numeric',year:'numeric',hour:'2-digit',minute:'2-digit',second:'2-digit',hour12:false})}</span>
          <span style={{color:'var(--t3)'}}>UTC {time.toISOString().slice(11,19)}</span>
        </div>
      </div>

      <div className="shell">
        {/* LEFT SIDEBAR */}
        <div className="sidebar">
          <div className="ph"><div className="pt">◆ Risk Indices</div><span className="pb" style={{background:'var(--amberbg)',color:'var(--amber)'}}>LIVE</span></div>
          <div className="pbd">
            {RISKS.map(r=><div key={r.id} className="rg">
              <div className="rg-t"><span className="rg-l">{r.l}</span><span className="rg-v" style={{color:r.c}}>{r.v}</span></div>
              <div className="rg-b"><div className="rg-f" style={{width:r.v+'%',background:r.c}}/></div>
              <div className="rg-m">
                <span style={{color:r.dir==='up'?'var(--red)':'var(--grn)'}}>{r.d} {r.dir==='up'?'▲':'▼'}</span>
                <span style={{color:r.v>=75?'var(--red)':r.v>=50?'var(--amber)':'var(--grn)',fontWeight:600}}>{r.st}</span>
              </div>
            </div>)}
          </div>
          <div className="ph"><div className="pt">◆ Regional Risk</div></div>
          <div className="pbd">
            {REGS.map((r,i)=><div key={i} className="rr">
              <span style={{color:'var(--t2)',flex:1}}>{r.r}</span>
              <span style={{color:r.v>=75?'var(--red)':r.v>=50?'var(--amber)':'var(--grn)',fontWeight:600,width:28,textAlign:'right'}}>{r.v}</span>
              <span style={{color:'var(--t3)',width:22,textAlign:'right',fontSize:9}}>{r.n}</span>
              <span style={{color:'var(--red)',width:35,textAlign:'right',fontSize:9}}>{r.d}</span>
            </div>)}
            <div style={{display:'flex',justifyContent:'space-between',font:'400 8px var(--mono)',color:'var(--t3)',marginTop:4,paddingTop:4,borderTop:'1px solid var(--bdr)'}}>
              <span>REGION</span><span>IDX</span><span>#</span><span>Δ QoQ</span>
            </div>
          </div>
        </div>

        {/* CENTER */}
        <div className="center">
          {/* MAP */}
          <div style={{flex:'1 1 55%',minHeight:0,borderBottom:'1px solid var(--bdr)'}}>
            <div className="mwrap">
              <svg viewBox="0 0 960 480" preserveAspectRatio="xMidYMid meet">
                <defs>
                  {/* Ocean gradient */}
                  <radialGradient id="ocean" cx="50%" cy="50%" r="60%">
                    <stop offset="0%" stopColor="#060d18"/>
                    <stop offset="100%" stopColor="#020508"/>
                  </radialGradient>
                  {/* Land gradient */}
                  <linearGradient id="land" x1="0" y1="0" x2="0" y2="1">
                    <stop offset="0%" stopColor="#0f1e14"/>
                    <stop offset="100%" stopColor="#0a1610"/>
                  </linearGradient>
                  {/* Glow filter for markers */}
                  <filter id="glow" x="-100%" y="-100%" width="300%" height="300%">
                    <feGaussianBlur stdDeviation="3" result="blur"/>
                    <feComposite in="SourceGraphic" in2="blur" operator="over"/>
                  </filter>
                  {/* Hotzone glow */}
                  <filter id="hzglow" x="-50%" y="-50%" width="200%" height="200%">
                    <feGaussianBlur stdDeviation="12" result="blur"/>
                    <feComposite in="SourceGraphic" in2="blur" operator="over"/>
                  </filter>
                  {/* Marker shadow */}
                  <filter id="mshadow"><feDropShadow dx="0" dy="1" stdDeviation="2" floodColor="#000" floodOpacity=".5"/></filter>
                </defs>
                {/* Ocean bg */}
                <rect width="960" height="480" fill="url(#ocean)"/>
                {/* Graticule grid */}
                {[...Array(7)].map((_,i)=><line key={'lat'+i} x1="0" y1={60+i*55} x2="960" y2={60+i*55} stroke="#0a1520" strokeWidth=".4" strokeDasharray="2,6"/>)}
                {[...Array(13)].map((_,i)=><line key={'lon'+i} x1={80+i*65} y1="0" x2={80+i*65} y2="480" stroke="#0a1520" strokeWidth=".4" strokeDasharray="2,6"/>)}
                {/* Equator */}
                <line x1="0" y1="240" x2="960" y2="240" stroke="#0f1f2f" strokeWidth=".6" strokeDasharray="4,4"/>
                {/* Prime meridian */}
                <line x1="480" y1="0" x2="480" y2="480" stroke="#0f1f2f" strokeWidth=".6" strokeDasharray="4,4"/>

                {/* ══ NORTH AMERICA ══ */}
                {/* Canada */}
                <path d="M85,42 L95,38 L115,35 L140,33 L165,30 L185,32 L210,35 L228,40 L240,45 L248,42 L260,45 L268,50 L265,55 L255,58 L245,62 L240,58 L230,55 L220,52 L212,55 L205,60 L195,58 L188,62 L180,58 L170,55 L160,52 L148,55 L138,60 L128,58 L118,55 L105,58 L98,62 L92,58 L88,50Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Alaska */}
                <path d="M55,50 L65,42 L80,40 L88,45 L85,52 L75,58 L62,56Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* USA */}
                <path d="M92,62 L105,60 L118,58 L138,62 L160,64 L180,65 L200,66 L220,68 L240,70 L258,72 L268,80 L265,88 L260,96 L252,104 L248,112 L242,118 L235,122 L228,118 L220,115 L210,118 L202,122 L195,118 L188,112 L178,108 L168,112 L158,115 L148,118 L140,122 L132,126 L125,130 L118,128 L108,124 L100,120 L95,115 L90,108 L88,100 L86,92 L85,82 L88,72Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Mexico */}
                <path d="M100,130 L118,132 L132,130 L140,128 L148,132 L155,140 L158,148 L155,158 L148,165 L142,172 L135,178 L128,175 L122,168 L118,160 L112,155 L108,148 L102,142 L98,136Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Central America */}
                <path d="M135,178 L142,180 L150,185 L158,192 L165,198 L168,205 L165,212 L158,218 L152,215 L148,210 L142,205 L138,198 L135,192 L132,185Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Caribbean */}
                <path d="M175,165 L188,160 L198,162 L205,168 L202,175 L192,178 L182,175 L175,170Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".5"/>
                <path d="M208,170 L218,168 L225,172 L222,178 L215,180 L208,176Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".5"/>

                {/* ══ SOUTH AMERICA ══ */}
                {/* Colombia/Venezuela */}
                <path d="M168,218 L178,215 L190,212 L202,210 L215,212 L225,218 L232,225 L228,232 L220,235 L210,238 L200,240 L190,238 L182,235 L175,230 L170,225Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Brazil */}
                <path d="M195,240 L210,238 L225,240 L240,248 L252,258 L260,270 L265,285 L262,300 L258,315 L250,328 L242,338 L232,345 L222,348 L212,345 L202,338 L195,328 L190,315 L188,300 L186,285 L185,270 L188,255 L192,245Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Peru/Bolivia */}
                <path d="M165,240 L175,238 L185,240 L188,255 L186,270 L185,285 L180,298 L172,305 L165,298 L160,288 L155,275 L152,262 L155,250Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Argentina/Chile */}
                <path d="M172,310 L185,305 L195,315 L205,328 L212,342 L215,358 L212,375 L206,390 L198,402 L190,410 L185,405 L180,395 L175,382 L170,368 L168,352 L166,338 L168,325Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>

                {/* ══ EUROPE ══ */}
                {/* Scandinavia */}
                <path d="M445,22 L452,18 L460,20 L465,28 L468,38 L470,48 L468,58 L462,65 L455,60 L450,52 L448,42 L445,32Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* UK/Ireland */}
                <path d="M418,52 L425,48 L432,50 L435,56 L432,62 L428,66 L422,64 L418,58Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".5"/>
                <path d="M412,56 L416,54 L418,58 L415,62 L412,60Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".5"/>
                {/* Western Europe */}
                <path d="M432,68 L440,65 L448,62 L458,60 L468,62 L478,65 L482,72 L478,80 L472,85 L465,88 L458,85 L450,82 L442,80 L435,76Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Iberia */}
                <path d="M420,82 L432,78 L442,82 L445,90 L442,98 L435,102 L425,100 L418,96 L416,90Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Italy */}
                <path d="M458,88 L462,85 L468,88 L472,95 L475,102 L472,110 L468,115 L462,112 L458,105 L456,98Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Eastern Europe */}
                <path d="M478,52 L490,48 L502,50 L512,55 L518,62 L520,72 L518,82 L512,88 L505,92 L498,88 L490,85 L485,80 L480,72 L478,62Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Greece/Turkey */}
                <path d="M478,95 L490,92 L502,95 L510,100 L518,105 L525,102 L532,105 L538,110 L535,118 L528,120 L520,118 L512,115 L505,112 L498,108 L490,105 L485,100Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>

                {/* ══ AFRICA ══ */}
                {/* North Africa */}
                <path d="M410,115 L425,112 L442,110 L458,112 L475,115 L490,118 L502,120 L510,125 L515,132 L512,140 L508,148 L502,152 L495,148 L488,145 L480,142 L472,140 L462,138 L452,140 L442,142 L432,140 L422,138 L415,132 L412,125Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* West Africa */}
                <path d="M400,155 L415,148 L430,145 L445,148 L455,155 L458,165 L455,175 L448,182 L440,185 L430,188 L420,185 L412,180 L405,172 L400,165Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Central/East Africa */}
                <path d="M458,155 L472,148 L488,150 L502,155 L515,162 L522,172 L525,185 L522,198 L518,212 L512,225 L505,235 L498,245 L490,252 L482,248 L475,240 L468,232 L462,222 L458,210 L455,198 L452,185 L455,172Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Southern Africa */}
                <path d="M462,255 L475,248 L488,252 L498,260 L505,272 L508,285 L505,298 L498,310 L488,318 L478,322 L468,318 L458,312 L452,302 L448,290 L450,278 L455,265Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Madagascar */}
                <path d="M518,278 L524,272 L528,280 L526,292 L522,300 L516,296 L514,288Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".5"/>

                {/* ══ ASIA ══ */}
                {/* Russia */}
                <path d="M520,28 L545,22 L575,20 L608,18 L640,20 L672,22 L700,25 L728,28 L752,32 L770,38 L780,45 L775,52 L768,58 L758,55 L748,50 L735,48 L720,45 L702,42 L682,40 L660,42 L638,45 L618,48 L598,52 L578,55 L558,52 L540,48 L528,45 L522,38Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Middle East */}
                <path d="M510,118 L525,115 L538,118 L548,125 L555,135 L558,145 L555,155 L548,162 L540,168 L530,165 L522,158 L515,150 L510,140 L508,130Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Arabian Peninsula */}
                <path d="M520,145 L535,140 L548,145 L558,155 L562,168 L558,178 L550,185 L540,182 L530,178 L522,172 L518,162 L518,152Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Central Asia */}
                <path d="M545,62 L570,58 L595,60 L618,65 L632,72 L628,82 L620,88 L608,85 L595,82 L580,80 L568,78 L555,75 L548,70Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Iran/Afghanistan */}
                <path d="M538,90 L555,85 L572,88 L585,95 L592,105 L588,115 L580,122 L568,125 L555,122 L545,115 L538,108 L535,98Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* India */}
                <path d="M585,125 L598,120 L612,122 L625,128 L632,138 L635,150 L632,165 L625,178 L618,188 L608,195 L598,192 L590,185 L585,175 L580,162 L578,148 L580,135Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Sri Lanka */}
                <path d="M610,200 L616,196 L620,202 L618,210 L612,212 L608,206Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".4"/>
                {/* China */}
                <path d="M632,60 L655,55 L678,58 L700,62 L720,68 L738,75 L748,85 L745,98 L738,108 L728,115 L718,120 L705,122 L692,118 L678,115 L665,112 L652,108 L642,102 L635,95 L630,85 L628,72Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Korea */}
                <path d="M738,82 L745,78 L750,82 L752,90 L748,98 L742,102 L738,96 L736,88Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".5"/>
                {/* Japan */}
                <path d="M758,72 L765,68 L772,72 L775,80 L772,90 L768,98 L762,105 L758,100 L755,92 L754,82Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* SE Asia mainland */}
                <path d="M648,148 L662,142 L678,145 L692,150 L702,158 L698,170 L690,180 L678,185 L668,188 L658,192 L648,188 L642,178 L640,168 L642,158Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Philippines */}
                <path d="M722,155 L728,150 L734,155 L732,165 L728,172 L722,168Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".5"/>
                {/* Indonesia */}
                <path d="M660,210 L678,205 L698,208 L718,212 L738,215 L752,220 L748,228 L738,232 L718,235 L698,232 L678,228 L662,225 L655,218Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* Borneo */}
                <path d="M702,195 L712,190 L720,195 L718,205 L710,210 L702,205Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".5"/>
                {/* Papua */}
                <path d="M758,220 L772,215 L785,220 L790,228 L785,235 L775,238 L765,235 L758,228Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".5"/>

                {/* ══ OCEANIA ══ */}
                {/* Australia */}
                <path d="M712,290 L732,282 L755,278 L778,280 L798,285 L815,295 L825,308 L828,322 L822,338 L812,350 L798,358 L782,362 L765,360 L748,355 L735,345 L725,332 L718,318 L714,305Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".6"/>
                {/* New Zealand */}
                <path d="M842,345 L848,340 L852,348 L850,358 L846,365 L840,360 L838,352Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".5"/>
                <path d="M845,368 L850,365 L852,372 L848,378 L844,375Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".5"/>

                {/* ══ GREENLAND / ICELAND ══ */}
                <path d="M320,18 L342,12 L365,15 L378,22 L375,35 L365,42 L350,45 L335,42 L322,35 L318,28Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".5"/>
                <path d="M395,35 L402,32 L408,35 L406,42 L400,44 L395,40Z" fill="url(#land)" stroke="#1a3520" strokeWidth=".4"/>

                {/* ══ HOTZONE OVERLAYS ══ */}
                <ellipse cx="530" cy="150" rx="65" ry="35" fill="rgba(255,59,48,.04)" stroke="none" filter="url(#hzglow)"/>
                <ellipse cx="530" cy="150" rx="65" ry="35" fill="none" stroke="rgba(255,59,48,.12)" strokeWidth=".8" strokeDasharray="4,3"/>
                <ellipse cx="480" cy="100" rx="55" ry="30" fill="rgba(255,59,48,.03)" stroke="none" filter="url(#hzglow)"/>
                <ellipse cx="480" cy="100" rx="55" ry="30" fill="none" stroke="rgba(255,59,48,.1)" strokeWidth=".8" strokeDasharray="4,3"/>
                <ellipse cx="720" cy="95" rx="50" ry="28" fill="rgba(255,149,0,.03)" stroke="none" filter="url(#hzglow)"/>
                <ellipse cx="720" cy="95" rx="50" ry="28" fill="none" stroke="rgba(255,149,0,.1)" strokeWidth=".8" strokeDasharray="4,3"/>

                {/* ══ CONNECTION LINES ══ */}
                {CONNS.map(([fromId,toId,label,color],ci)=>{
                  const f=INCIDENTS.find(i=>i.id===fromId);const t=INCIDENTS.find(i=>i.id===toId);
                  if(!f||!t)return null;
                  const[x1,y1]=proj(f.lat,f.lon);const[x2,y2]=proj(t.lat,t.lon);
                  const mx=(x1+x2)/2,my=(y1+y2)/2-15;
                  return <g key={'c'+ci} opacity=".5">
                    <path d={`M${x1},${y1} Q${mx},${my} ${x2},${y2}`} fill="none" stroke={color} strokeWidth=".8" className="conn-line" opacity=".4"/>
                  </g>;
                })}

                {/* ══ INCIDENT MARKERS ══ */}
                {fi.map(inc=>{const[x,y]=proj(inc.lat,inc.lon);const col=SC[inc.sv];
                  return <g key={inc.id} style={{cursor:'pointer'}} filter="url(#mshadow)" onMouseEnter={e=>setTt({x:e.clientX+14,y:e.clientY-10,i:inc})} onMouseLeave={()=>setTt(null)}>
                    {inc.sv==='critical'&&<circle className="mpulse" cx={x} cy={y} r="5" fill="none" stroke={col} strokeWidth="1.5" opacity=".6"/>}
                    <circle cx={x} cy={y} r={inc.sv==='critical'?5:4} fill={col} opacity=".9" stroke="rgba(0,0,0,.6)" strokeWidth="1.5"/>
                    <circle cx={x} cy={y} r="1.5" fill="#fff" opacity=".95"/>
                  </g>;
                })}
              </svg>
              <div className="mfilt">
                {['ALL','CONFLICT','CLIMATE','CYBER','ENERGY','ECONOMIC'].map(f=>(
                  <button key={f} className={`mfb ${mf===f?'a':''}`} onClick={()=>setMf(f)}>{f}</button>
                ))}
              </div>
              <div className="mstat">
                <div className="ms"><span className="msv" style={{color:'var(--red)'}}>{INCIDENTS.filter(i=>i.sv==='critical').length}</span><span className="msl">Critical</span></div>
                <div className="ms"><span className="msv" style={{color:'var(--amber)'}}>{INCIDENTS.filter(i=>i.sv==='high').length}</span><span className="msl">High</span></div>
                <div className="ms"><span className="msv" style={{color:'var(--t1)'}}>{INCIDENTS.length}</span><span className="msl">Total</span></div>
              </div>
              <div className="mleg">
                {Object.entries(CC).slice(0,6).map(([k,v])=><span key={k} className="ml"><span className="mld" style={{background:v}}></span>{k}</span>)}
              </div>
            </div>
          </div>

          {/* BOTTOM: Intel + Trends */}
          <div style={{flex:'1 1 45%',display:'grid',gridTemplateColumns:'1fr 1fr',overflow:'hidden'}}>
            {/* Intel Feed */}
            <div style={{overflow:'auto',borderRight:'1px solid var(--bdr)'}}>
              <div className="ph"><div className="pt">◆ Intelligence Feed</div><span className="pb" style={{background:'var(--redbg)',color:'var(--red)'}}>{INCIDENTS.length} ACTIVE</span></div>
              <div className="pbd">
                {INCIDENTS.map(inc=>{
                  const q=encodeURIComponent(inc.t.split('—')[0].trim());
                  const url=`https://news.google.com/search?q=${q}`;
                  return <a key={inc.id} href={url} target="_blank" rel="noopener noreferrer" style={{textDecoration:'none',color:'inherit',display:'block'}}>
                  <div className="fi">
                  <div className="fit">
                    <div className="fis" style={{background:SC[inc.sv]}}/>
                    <span className="fitg" style={{background:CC[inc.cat]+'20',color:CC[inc.cat],border:'1px solid '+CC[inc.cat]+'40'}}>{inc.cat}</span>
                    <span style={{font:'400 9px var(--mono)',color:'var(--t3)'}}>{inc.reg}</span>
                    <span className="fitm">{inc.tm}</span>
                  </div>
                  <div className="fitt" style={{cursor:'pointer'}}>{inc.t} <span style={{color:'var(--amber)',fontSize:9}}>↗</span></div>
                  <div className="fisu">{inc.imp}</div>
                </div></a>;})}
              </div>
            </div>

            {/* Trend Chart */}
            <div style={{overflow:'auto'}}>
              <div className="ph"><div className="pt">◆ Risk Trend Analysis</div></div>
              <div className="pbd">
                <div className="ctabs">
                  {['1M','6M','1Y'].map(p=><button key={p} className={`ct ${tp===p?'a':''}`} onClick={()=>setTp(p)}>{p}</button>)}
                </div>
                <AreaChartSVG data={TREND[tp]} keys={['con','geo','clim','cyb']} colors={['#ff375f','#ff3b30','#ff9500','#bf5af2']}/>
                <div style={{display:'flex',gap:12,marginTop:6,font:'400 9px var(--mono)'}}>
                  {[['Conflict','#ff375f'],['Geopolitical','#ff3b30'],['Climate','#ff9500'],['Cyber','#bf5af2']].map(([n,c])=>(
                    <span key={n} style={{display:'flex',alignItems:'center',gap:3}}><span style={{width:8,height:2,background:c,display:'inline-block'}}/><span style={{color:'var(--t2)'}}>{n}</span></span>
                  ))}
                </div>
              </div>
            </div>
          </div>
        </div>

        {/* RIGHT PANEL */}
        <div className="rpanel">
          {/* SPGI */}
          <div className="ph"><div className="pt">◆ SPGI — S&P Global</div><span className="pb" style={{background:'var(--grnbg)',color:'var(--grn)'}}>+1.24%</span></div>
          <div className="pbd">
            <div style={{display:'flex',alignItems:'baseline',gap:8}}>
              <span style={{font:'700 22px var(--mono)',color:'var(--grn)'}}>$512.38</span>
              <span style={{font:'500 11px var(--mono)',color:'var(--grn)'}}>+$6.28</span>
            </div>
            <div style={{font:'400 9px var(--mono)',color:'var(--t3)',marginTop:2}}>NYSE · Intraday · Vol: 1.2M</div>
            <div style={{marginTop:8}}><Sparkline data={SPGI} dataKey="p" w={260} h={55} color="#30d158"/></div>
            <div style={{display:'grid',gridTemplateColumns:'1fr 1fr 1fr',gap:8,marginTop:8,font:'400 9px var(--mono)'}}>
              <div><span style={{color:'var(--t3)'}}>Open</span><br/><span style={{color:'var(--t1)'}}>508.20</span></div>
              <div><span style={{color:'var(--t3)'}}>High</span><br/><span style={{color:'var(--t1)'}}>513.10</span></div>
              <div><span style={{color:'var(--t3)'}}>Low</span><br/><span style={{color:'var(--t1)'}}>508.05</span></div>
              <div><span style={{color:'var(--t3)'}}>Mkt Cap</span><br/><span style={{color:'var(--t1)'}}>$161.2B</span></div>
              <div><span style={{color:'var(--t3)'}}>P/E</span><br/><span style={{color:'var(--t1)'}}>48.32</span></div>
              <div><span style={{color:'var(--t3)'}}>52w H/L</span><br/><span style={{color:'var(--t1)'}}>520/380</span></div>
            </div>
          </div>

          {/* Markets */}
          {Object.entries(MKTS).map(([sec,items])=><React.Fragment key={sec}>
            <div className="msec">{sec}</div>
            <div style={{padding:'4px 12px'}}>
              {items.map((m,i)=><div key={i} className="mr">
                <span className="mrs">{m.s}</span>
                <span style={{color:'var(--t3)',flex:1,fontSize:10}}>{m.n}</span>
                <span className="mrp">{m.p}</span>
                <span className="mrc" style={{color:m.u?'var(--grn)':'var(--red)'}}>{m.c}</span>
              </div>)}
            </div>
          </React.Fragment>)}
        </div>
      </div>

      {/* News Ticker */}
      <div className="newstick">
        <span className="label">◆ WIRE</span>
        <div className="nscroll">
          {[...NEWS,...NEWS].map((n,i)=><span key={i} className="nitem">
            <span className="ndot" style={{background:n.c}}></span>
            {n.t}
            <span className="nsrc">{n.s}</span>
          </span>)}
        </div>
      </div>

      {/* Tooltip */}
      {tt&&<div className="tt" style={{left:tt.x,top:tt.y}}>
        <h5 style={{color:SC[tt.i.sv]}}>{tt.i.cat} — {tt.i.sv.toUpperCase()}</h5>
        <p style={{color:'var(--t1)',fontWeight:500}}>{tt.i.t}</p>
        <p style={{marginTop:3}}>{tt.i.reg} · {tt.i.tm} ago</p>
        <p style={{marginTop:2,color:'var(--amber)'}}>{tt.i.imp}</p>
      </div>}
    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
</script>
</body>
</html>
