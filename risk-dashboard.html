<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>S&amp;P Global — Climate Security Risk Dashboard</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/recharts/2.15.0/Recharts.min.js"></script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
  * { margin:0; padding:0; box-sizing:border-box; }
  body { font-family:'Inter',sans-serif; background:#0a0e17; color:#e2e8f0; overflow-x:hidden; }
  ::-webkit-scrollbar { width:6px; }
  ::-webkit-scrollbar-track { background:#0a0e17; }
  ::-webkit-scrollbar-thumb { background:#1e293b; border-radius:3px; }

  .ticker-bar { background:#060910; border-bottom:1px solid #1e293b; padding:6px 0; overflow:hidden; white-space:nowrap; }
  .ticker-content { display:inline-block; animation: ticker 30s linear infinite; }
  .ticker-content:hover { animation-play-state: paused; }
  @keyframes ticker { 0%{transform:translateX(0)} 100%{transform:translateX(-50%)} }
  .ticker-item { display:inline-flex; align-items:center; gap:6px; margin-right:40px; font-size:12px; font-weight:500; }
  .ticker-item .symbol { color:#94a3b8; }
  .ticker-item .price { color:#e2e8f0; }
  .ticker-item .change.up { color:#22c55e; }
  .ticker-item .change.down { color:#ef4444; }

  header { background:linear-gradient(135deg,#0f1729 0%,#162040 100%); border-bottom:1px solid #1e293b; padding:16px 32px; display:flex; align-items:center; justify-content:space-between; }
  .logo-area { display:flex; align-items:center; gap:16px; }
  .logo-mark { width:36px; height:36px; background:linear-gradient(135deg,#3b82f6,#06b6d4); border-radius:8px; display:flex; align-items:center; justify-content:center; font-weight:700; font-size:14px; color:#fff; }
  .logo-text h1 { font-size:16px; font-weight:600; letter-spacing:0.5px; }
  .logo-text span { font-size:11px; color:#64748b; font-weight:400; letter-spacing:1px; text-transform:uppercase; }
  .header-meta { display:flex; gap:24px; align-items:center; font-size:12px; color:#64748b; }
  .live-dot { width:8px; height:8px; background:#22c55e; border-radius:50%; animation:pulse 2s infinite; display:inline-block; margin-right:6px; }
  @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.4} }

  .dashboard { padding:24px 32px; display:grid; gap:20px; }
  .top-row { display:grid; grid-template-columns: repeat(4,1fr); gap:16px; }

  .card { background:#111827; border:1px solid #1e293b; border-radius:12px; padding:20px; position:relative; overflow:hidden; }
  .card::before { content:''; position:absolute; top:0; left:0; right:0; height:2px; }
  .card.critical::before { background:linear-gradient(90deg,#ef4444,#f97316); }
  .card.high::before { background:linear-gradient(90deg,#f97316,#eab308); }
  .card.medium::before { background:linear-gradient(90deg,#eab308,#3b82f6); }
  .card.low::before { background:linear-gradient(90deg,#3b82f6,#22c55e); }
  .card-label { font-size:11px; text-transform:uppercase; letter-spacing:1.2px; color:#64748b; margin-bottom:8px; font-weight:500; }
  .card-value { font-size:28px; font-weight:700; line-height:1.2; }
  .card-sub { font-size:12px; color:#64748b; margin-top:4px; display:flex; align-items:center; gap:4px; }
  .card-sub .up { color:#22c55e; }
  .card-sub .down { color:#ef4444; }

  .mid-row { display:grid; grid-template-columns: 2fr 1fr; gap:16px; }
  .bottom-row { display:grid; grid-template-columns: 1fr 1fr; gap:16px; }

  .section-title { font-size:13px; font-weight:600; text-transform:uppercase; letter-spacing:1px; color:#94a3b8; margin-bottom:16px; display:flex; align-items:center; gap:8px; }
  .section-title .dot { width:6px; height:6px; border-radius:50%; }

  /* World Map */
  .map-container { position:relative; width:100%; padding-top:50%; }
  .map-svg { position:absolute; top:0; left:0; width:100%; height:100%; }

  .incident-marker { cursor:pointer; transition:all 0.2s; }
  .incident-marker:hover { transform:scale(1.3); }
  .pulse-ring { animation:markerPulse 2s infinite; }
  @keyframes markerPulse { 0%{r:6;opacity:0.8} 100%{r:18;opacity:0} }

  .map-legend { display:flex; gap:16px; margin-top:12px; font-size:11px; color:#94a3b8; }
  .legend-item { display:flex; align-items:center; gap:5px; }
  .legend-dot { width:8px; height:8px; border-radius:50%; }

  /* Incidents Feed */
  .feed-item { padding:12px 0; border-bottom:1px solid #1e293b; display:flex; gap:12px; align-items:flex-start; }
  .feed-item:last-child { border-bottom:none; }
  .feed-severity { width:8px; height:8px; border-radius:50%; margin-top:5px; flex-shrink:0; }
  .feed-content h4 { font-size:13px; font-weight:500; line-height:1.4; color:#e2e8f0; }
  .feed-content p { font-size:11px; color:#64748b; margin-top:2px; }
  .feed-meta { font-size:10px; color:#475569; margin-top:4px; display:flex; gap:12px; }

  /* Risk Matrix */
  .risk-matrix { display:grid; grid-template-columns: 30px repeat(5,1fr); grid-template-rows: repeat(5,1fr) 30px; gap:3px; height:260px; }
  .matrix-cell { border-radius:4px; display:flex; align-items:center; justify-content:center; font-size:10px; font-weight:600; color:rgba(255,255,255,0.8); cursor:pointer; transition:all 0.15s; position:relative; }
  .matrix-cell:hover { transform:scale(1.05); z-index:2; }
  .matrix-cell.sev-critical { background:rgba(239,68,68,0.7); }
  .matrix-cell.sev-high { background:rgba(249,115,22,0.6); }
  .matrix-cell.sev-medium { background:rgba(234,179,8,0.5); }
  .matrix-cell.sev-low { background:rgba(34,197,94,0.4); }
  .matrix-cell.sev-minimal { background:rgba(59,130,246,0.3); }
  .matrix-label { display:flex; align-items:center; justify-content:center; font-size:9px; color:#475569; text-transform:uppercase; letter-spacing:0.5px; }
  .matrix-label.y-axis { writing-mode:vertical-lr; transform:rotate(180deg); }

  /* Trend chart */
  .trend-tabs { display:flex; gap:8px; margin-bottom:16px; }
  .trend-tab { padding:5px 12px; border-radius:6px; font-size:11px; font-weight:500; cursor:pointer; border:1px solid #1e293b; background:transparent; color:#64748b; transition:all 0.15s; }
  .trend-tab.active { background:#1e293b; color:#e2e8f0; border-color:#334155; }
  .trend-tab:hover { border-color:#334155; }

  /* SPGI Ticker Widget */
  .spgi-widget { background:linear-gradient(135deg,#0f1729,#1a2744); border:1px solid #1e3a5f; border-radius:12px; padding:20px; }
  .spgi-price { font-size:32px; font-weight:700; }
  .spgi-change { font-size:14px; font-weight:500; margin-top:2px; }
  .spgi-label { font-size:11px; color:#64748b; margin-top:2px; }

  /* Tooltip */
  .tooltip { position:fixed; background:#1e293b; border:1px solid #334155; border-radius:8px; padding:10px 14px; font-size:12px; pointer-events:none; z-index:100; max-width:260px; box-shadow:0 8px 24px rgba(0,0,0,0.4); }
  .tooltip h5 { font-weight:600; margin-bottom:4px; color:#e2e8f0; }
  .tooltip p { color:#94a3b8; font-size:11px; line-height:1.4; }

  .filter-bar { display:flex; gap:8px; flex-wrap:wrap; margin-bottom:4px; }
  .filter-chip { padding:4px 10px; border-radius:20px; font-size:11px; border:1px solid #1e293b; background:transparent; color:#94a3b8; cursor:pointer; transition:all 0.15s; }
  .filter-chip.active { background:#1e293b; color:#e2e8f0; border-color:#3b82f6; }
  .filter-chip:hover { border-color:#334155; }
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const { useState, useEffect, useRef, useMemo } = React;
const { LineChart, Line, AreaChart, Area, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip: RTooltip, ResponsiveContainer, PieChart, Pie, Cell, RadarChart, Radar, PolarGrid, PolarAngleAxis, PolarRadiusAxis } = Recharts;

// ─── DATA ────────────────────────────────────────
const TICKER_DATA = [
  { symbol:'SPGI', price:'512.38', change:'+1.24%', up:true },
  { symbol:'MSCI', price:'587.92', change:'-0.38%', up:false },
  { symbol:'MCO', price:'478.15', change:'+0.87%', up:true },
  { symbol:'ICE', price:'156.73', change:'+0.42%', up:true },
  { symbol:'LSEG', price:'112.40', change:'-0.15%', up:false },
  { symbol:'CME', price:'221.56', change:'+0.63%', up:true },
  { symbol:'NDAQ', price:'78.32', change:'-0.21%', up:false },
  { symbol:'FDS', price:'458.89', change:'+1.05%', up:true },
];

const RISK_CATEGORIES = [
  { label:'Physical Risk Events', value:847, trend:'+12%', up:false, type:'critical' },
  { label:'Transition Risk Signals', value:234, trend:'+8%', up:false, type:'high' },
  { label:'Regulatory Actions', value:156, trend:'+23%', up:false, type:'medium' },
  { label:'Overall Climate VaR', value:'$4.2T', trend:'+3.1%', up:false, type:'critical' },
];

const INCIDENTS = [
  { id:1, title:'Category 5 Cyclone Approaching Bay of Bengal — 2.4M at Risk', severity:'critical', region:'South Asia', date:'2h ago', lat:16, lon:87, type:'Extreme Weather', impact:'$8.2B estimated damage' },
  { id:2, title:'Record Wildfire Season in Mediterranean — 340K Hectares Burned', severity:'critical', region:'Southern Europe', date:'4h ago', lat:38, lon:23, type:'Wildfire', impact:'$3.1B estimated damage' },
  { id:3, title:'Severe Drought Threatens Central Africa Food Supply Chains', severity:'high', region:'Central Africa', date:'6h ago', lat:4, lon:22, type:'Drought', impact:'12M people affected' },
  { id:4, title:'Flooding in Southeast Brazil — Major Port Operations Halted', severity:'high', region:'South America', date:'8h ago', lat:-23, lon:-43, type:'Flooding', impact:'$1.8B trade disruption' },
  { id:5, title:'Arctic Permafrost Methane Release Exceeds Models by 40%', severity:'high', region:'Arctic', date:'12h ago', lat:72, lon:125, type:'Emissions', impact:'Tipping point risk elevated' },
  { id:6, title:'EU Carbon Border Tax Phase 2 — New Sectors Added', severity:'medium', region:'Europe', date:'1d ago', lat:50, lon:10, type:'Regulatory', impact:'€45B in affected trade' },
  { id:7, title:'Pacific Island Nation Declares Climate Emergency — Sea Level +18cm', severity:'critical', region:'Oceania', date:'1d ago', lat:-8, lon:160, type:'Sea Level Rise', impact:'$420M relocation costs' },
  { id:8, title:'Coral Bleaching Event — Great Barrier Reef 60% Affected', severity:'high', region:'Oceania', date:'1d ago', lat:-18, lon:147, type:'Ecosystem', impact:'$6.4B tourism at risk' },
  { id:9, title:'Water Stress Crisis in Northern India — Agricultural Output -15%', severity:'high', region:'South Asia', date:'2d ago', lat:28, lon:77, type:'Water Stress', impact:'$12B crop losses' },
  { id:10, title:'Hurricane-Grade Storm Strikes US Gulf Coast Refineries', severity:'critical', region:'North America', date:'2d ago', lat:29, lon:-90, type:'Extreme Weather', impact:'$5.6B infrastructure' },
  { id:11, title:'Sahel Desertification Accelerates — Migration Pressure Increases', severity:'medium', region:'West Africa', date:'2d ago', lat:15, lon:0, type:'Desertification', impact:'3.2M displaced' },
  { id:12, title:'Antarctic Ice Sheet Loss Rate Doubles Year-Over-Year', severity:'high', region:'Antarctica', date:'3d ago', lat:-75, lon:0, type:'Ice Melt', impact:'Long-term sea level +2.3m' },
  { id:13, title:'China Yangtze River Flooding Disrupts Chip Manufacturing', severity:'high', region:'East Asia', date:'3d ago', lat:30, lon:114, type:'Flooding', impact:'$4.1B supply chain' },
  { id:14, title:'Heatwave in Middle East — Grid Failures Across 3 Countries', severity:'medium', region:'Middle East', date:'3d ago', lat:25, lon:50, type:'Extreme Heat', impact:'$890M economic loss' },
];

const SEVERITY_COLORS = { critical:'#ef4444', high:'#f97316', medium:'#eab308', low:'#22c55e' };
const TYPE_COLORS = { 'Extreme Weather':'#ef4444', 'Wildfire':'#f97316', 'Drought':'#eab308', 'Flooding':'#3b82f6', 'Emissions':'#8b5cf6', 'Regulatory':'#06b6d4', 'Sea Level Rise':'#0ea5e9', 'Ecosystem':'#22c55e', 'Water Stress':'#f59e0b', 'Ice Melt':'#67e8f9', 'Extreme Heat':'#fb923c', 'Desertification':'#a78bfa' };

const TREND_DATA = {
  '6M': [
    {month:'Sep',physical:62,transition:28,regulatory:12},
    {month:'Oct',physical:71,transition:31,regulatory:15},
    {month:'Nov',physical:58,transition:35,regulatory:18},
    {month:'Dec',physical:85,transition:29,regulatory:22},
    {month:'Jan',physical:93,transition:38,regulatory:25},
    {month:'Feb',physical:104,transition:42,regulatory:31},
  ],
  '1Y': [
    {month:'Mar \'25',physical:45,transition:20,regulatory:8},
    {month:'May',physical:52,transition:22,regulatory:10},
    {month:'Jul',physical:68,transition:25,regulatory:11},
    {month:'Sep',physical:62,transition:28,regulatory:12},
    {month:'Nov',physical:58,transition:35,regulatory:18},
    {month:'Feb \'26',physical:104,transition:42,regulatory:31},
  ],
  '3Y': [
    {month:'2023',physical:32,transition:12,regulatory:4},
    {month:'Q2',physical:38,transition:15,regulatory:5},
    {month:'Q3',physical:41,transition:18,regulatory:6},
    {month:'2024',physical:48,transition:20,regulatory:7},
    {month:'Q2',physical:55,transition:23,regulatory:9},
    {month:'Q3',physical:60,transition:26,regulatory:11},
    {month:'2025',physical:72,transition:30,regulatory:15},
    {month:'Q2',physical:80,transition:34,regulatory:20},
    {month:'2026',physical:104,transition:42,regulatory:31},
  ],
};

const SPGI_CHART = [
  {t:'9:30',p:508.2},{t:'10:00',p:509.5},{t:'10:30',p:510.1},{t:'11:00',p:509.8},
  {t:'11:30',p:511.2},{t:'12:00',p:510.6},{t:'12:30',p:511.8},{t:'13:00',p:512.5},
  {t:'13:30',p:511.9},{t:'14:00',p:512.8},{t:'14:30',p:513.1},{t:'15:00',p:512.4},
  {t:'15:30',p:512.0},{t:'16:00',p:512.38},
];

const RISK_MATRIX_DATA = [
  // [likelihood(x 0-4), impact(y 0-4), count]
  [0,0,0],[1,0,1],[2,0,3],[3,0,2],[4,0,1],
  [0,1,2],[1,1,4],[2,1,6],[3,1,3],[4,1,2],
  [0,2,1],[1,2,5],[2,2,8],[3,2,7],[4,2,4],
  [0,3,0],[1,3,3],[2,3,6],[3,3,9],[4,3,5],
  [0,4,1],[1,4,2],[2,4,4],[3,4,7],[4,4,12],
];

const SECTOR_EXPOSURE = [
  { sector:'Energy', value:34 },
  { sector:'Agriculture', value:22 },
  { sector:'Real Estate', value:18 },
  { sector:'Transportation', value:12 },
  { sector:'Manufacturing', value:8 },
  { sector:'Finance', value:6 },
];
const PIE_COLORS = ['#ef4444','#f97316','#eab308','#3b82f6','#8b5cf6','#06b6d4'];

// ─── SIMPLE WORLD MAP SVG PATH (simplified) ──────
const WorldMap = ({ incidents, filter, onHover, onLeave }) => {
  const mapRef = useRef(null);
  // Convert lat/lon to x/y on our simplified projection
  const project = (lat, lon) => {
    const x = (lon + 180) * (900 / 360);
    const y = (90 - lat) * (450 / 180);
    return [x, y];
  };

  const filteredIncidents = filter === 'All' ? incidents : incidents.filter(i => i.severity === filter.toLowerCase());

  return (
    <svg viewBox="0 0 900 450" className="map-svg" style={{background:'#0a0e17'}}>
      {/* Grid lines */}
      {[...Array(7)].map((_,i) => <line key={`h${i}`} x1="0" y1={i*75} x2="900" y2={i*75} stroke="#1e293b" strokeWidth="0.5" />)}
      {[...Array(13)].map((_,i) => <line key={`v${i}`} x1={i*75} y1="0" x2={i*75} y2="450" stroke="#1e293b" strokeWidth="0.5" />)}

      {/* Simplified continent shapes */}
      {/* North America */}
      <path d="M120,60 L200,55 L230,80 L250,95 L240,130 L220,155 L190,170 L170,200 L155,195 L140,210 L120,200 L105,170 L95,140 L90,110 L100,80 Z" fill="#1a2744" stroke="#2d4a7a" strokeWidth="0.8"/>
      {/* Central America */}
      <path d="M140,210 L160,215 L170,230 L165,245 L155,250 L145,240 L135,225 Z" fill="#1a2744" stroke="#2d4a7a" strokeWidth="0.8"/>
      {/* South America */}
      <path d="M175,250 L200,245 L220,260 L230,290 L235,320 L225,355 L210,380 L195,390 L185,370 L175,340 L165,310 L160,280 L165,260 Z" fill="#1a2744" stroke="#2d4a7a" strokeWidth="0.8"/>
      {/* Europe */}
      <path d="M400,65 L430,55 L460,60 L480,70 L490,85 L485,105 L470,115 L450,120 L430,130 L410,125 L395,110 L390,90 Z" fill="#1a2744" stroke="#2d4a7a" strokeWidth="0.8"/>
      {/* Africa */}
      <path d="M410,145 L450,140 L480,150 L500,175 L510,210 L505,250 L495,290 L480,315 L460,330 L440,325 L420,305 L410,275 L405,240 L400,200 L395,170 Z" fill="#1a2744" stroke="#2d4a7a" strokeWidth="0.8"/>
      {/* Asia */}
      <path d="M490,50 L550,40 L620,45 L680,55 L720,70 L740,90 L750,120 L740,150 L720,160 L690,155 L660,165 L630,160 L600,150 L570,140 L540,125 L510,110 L495,90 L490,70 Z" fill="#1a2744" stroke="#2d4a7a" strokeWidth="0.8"/>
      {/* South/SE Asia */}
      <path d="M580,170 L620,165 L660,175 L680,190 L670,210 L640,215 L610,205 L590,195 Z" fill="#1a2744" stroke="#2d4a7a" strokeWidth="0.8"/>
      {/* Indonesia/Maritime SE Asia */}
      <path d="M660,225 L690,220 L720,225 L740,235 L730,245 L700,250 L670,245 L655,238 Z" fill="#1a2744" stroke="#2d4a7a" strokeWidth="0.8"/>
      {/* Australia */}
      <path d="M700,290 L750,280 L790,290 L810,310 L805,340 L785,355 L755,360 L725,350 L710,330 L700,310 Z" fill="#1a2744" stroke="#2d4a7a" strokeWidth="0.8"/>
      {/* Japan */}
      <path d="M750,85 L760,80 L768,90 L762,105 L752,100 Z" fill="#1a2744" stroke="#2d4a7a" strokeWidth="0.8"/>

      {/* Incident markers */}
      {filteredIncidents.map((inc) => {
        const [x, y] = project(inc.lat, inc.lon);
        const color = SEVERITY_COLORS[inc.severity];
        return (
          <g key={inc.id} className="incident-marker"
             onMouseEnter={(e) => onHover(inc, e)}
             onMouseLeave={onLeave}>
            <circle className="pulse-ring" cx={x} cy={y} r="6" fill="none" stroke={color} strokeWidth="1.5" opacity="0.6"/>
            <circle cx={x} cy={y} r="5" fill={color} opacity="0.85" stroke="#0a0e17" strokeWidth="1.5"/>
            <circle cx={x} cy={y} r="2" fill="#fff" opacity="0.9"/>
          </g>
        );
      })}
    </svg>
  );
};

// ─── MAIN DASHBOARD ──────────────────────────────
function Dashboard() {
  const [trendPeriod, setTrendPeriod] = useState('6M');
  const [sevFilter, setSevFilter] = useState('All');
  const [tooltip, setTooltip] = useState(null);
  const [time, setTime] = useState(new Date());

  useEffect(() => {
    const t = setInterval(() => setTime(new Date()), 1000);
    return () => clearInterval(t);
  }, []);

  const matrixSeverity = (x, y) => {
    const score = x + y;
    if (score >= 7) return 'critical';
    if (score >= 5) return 'high';
    if (score >= 3) return 'medium';
    if (score >= 1) return 'low';
    return 'minimal';
  };

  const handleIncidentHover = (inc, e) => {
    setTooltip({ x: e.clientX + 12, y: e.clientY - 10, incident: inc });
  };

  return (
    <div>
      {/* Ticker Bar */}
      <div className="ticker-bar">
        <div className="ticker-content">
          {[...TICKER_DATA, ...TICKER_DATA].map((t, i) => (
            <span key={i} className="ticker-item">
              <span className="symbol">{t.symbol}</span>
              <span className="price">${t.price}</span>
              <span className={`change ${t.up?'up':'down'}`}>{t.change}</span>
            </span>
          ))}
        </div>
      </div>

      {/* Header */}
      <header>
        <div className="logo-area">
          <div className="logo-mark">S&P</div>
          <div className="logo-text">
            <h1>Climate Security Risk Dashboard</h1>
            <span>S&P Global — Market Intelligence</span>
          </div>
        </div>
        <div className="header-meta">
          <span><span className="live-dot"></span>Live Monitoring</span>
          <span>{time.toLocaleString('en-US', {month:'short',day:'numeric',year:'numeric',hour:'2-digit',minute:'2-digit',second:'2-digit'})}</span>
          <span>UTC {time.toISOString().slice(11,19)}</span>
        </div>
      </header>

      <div className="dashboard">
        {/* KPI Cards */}
        <div className="top-row">
          {RISK_CATEGORIES.map((r, i) => (
            <div key={i} className={`card ${r.type}`}>
              <div className="card-label">{r.label}</div>
              <div className="card-value">{r.value}</div>
              <div className="card-sub">
                <span className={r.up?'up':'down'}>{r.up?'▲':'▲'} {r.trend}</span>
                <span style={{color:'#475569'}}>vs last quarter</span>
              </div>
            </div>
          ))}
        </div>

        {/* Map + SPGI Widget + Feed */}
        <div className="mid-row">
          <div className="card" style={{padding:'20px'}}>
            <div className="section-title">
              <span className="dot" style={{background:'#3b82f6'}}></span>
              Global Climate Incident Map
            </div>
            <div className="filter-bar">
              {['All','Critical','High','Medium'].map(f => (
                <button key={f} className={`filter-chip ${sevFilter===f?'active':''}`} onClick={()=>setSevFilter(f)}>{f}</button>
              ))}
            </div>
            <div className="map-container">
              <WorldMap incidents={INCIDENTS} filter={sevFilter}
                onHover={handleIncidentHover}
                onLeave={() => setTooltip(null)} />
            </div>
            <div className="map-legend">
              <span className="legend-item"><span className="legend-dot" style={{background:'#ef4444'}}></span>Critical</span>
              <span className="legend-item"><span className="legend-dot" style={{background:'#f97316'}}></span>High</span>
              <span className="legend-item"><span className="legend-dot" style={{background:'#eab308'}}></span>Medium</span>
              <span style={{marginLeft:'auto',color:'#475569',fontSize:'10px'}}>{INCIDENTS.length} active incidents tracked</span>
            </div>
          </div>

          <div style={{display:'flex',flexDirection:'column',gap:'16px'}}>
            {/* SPGI Widget */}
            <div className="spgi-widget">
              <div className="card-label">SPGI — S&P Global Inc.</div>
              <div className="spgi-price" style={{color:'#22c55e'}}>$512.38</div>
              <div className="spgi-change" style={{color:'#22c55e'}}>+$6.28 (+1.24%)</div>
              <div className="spgi-label">NYSE · Last updated {time.toLocaleTimeString()}</div>
              <div style={{marginTop:'12px',height:'80px'}}>
                <ResponsiveContainer width="100%" height="100%">
                  <AreaChart data={SPGI_CHART}>
                    <defs>
                      <linearGradient id="spgiGrad" x1="0" y1="0" x2="0" y2="1">
                        <stop offset="0%" stopColor="#22c55e" stopOpacity={0.3}/>
                        <stop offset="100%" stopColor="#22c55e" stopOpacity={0}/>
                      </linearGradient>
                    </defs>
                    <Area type="monotone" dataKey="p" stroke="#22c55e" fill="url(#spgiGrad)" strokeWidth={2} dot={false}/>
                  </AreaChart>
                </ResponsiveContainer>
              </div>
            </div>

            {/* Recent Incidents */}
            <div className="card" style={{flex:1,overflow:'auto',maxHeight:'340px'}}>
              <div className="section-title">
                <span className="dot" style={{background:'#ef4444'}}></span>
                Recent Incidents
              </div>
              {INCIDENTS.slice(0, 7).map(inc => (
                <div key={inc.id} className="feed-item">
                  <div className="feed-severity" style={{background:SEVERITY_COLORS[inc.severity]}}></div>
                  <div className="feed-content">
                    <h4>{inc.title}</h4>
                    <p>{inc.impact}</p>
                    <div className="feed-meta">
                      <span>{inc.type}</span>
                      <span>{inc.region}</span>
                      <span>{inc.date}</span>
                    </div>
                  </div>
                </div>
              ))}
            </div>
          </div>
        </div>

        {/* Bottom Row: Trend + Risk Matrix + Sector Exposure */}
        <div style={{display:'grid', gridTemplateColumns:'1fr 1fr 1fr', gap:'16px'}}>
          {/* Trend Chart */}
          <div className="card">
            <div className="section-title">
              <span className="dot" style={{background:'#8b5cf6'}}></span>
              Risk Event Trends
            </div>
            <div className="trend-tabs">
              {['6M','1Y','3Y'].map(p => (
                <button key={p} className={`trend-tab ${trendPeriod===p?'active':''}`} onClick={()=>setTrendPeriod(p)}>{p}</button>
              ))}
            </div>
            <ResponsiveContainer width="100%" height={200}>
              <AreaChart data={TREND_DATA[trendPeriod]}>
                <defs>
                  <linearGradient id="physGrad" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stopColor="#ef4444" stopOpacity={0.3}/><stop offset="100%" stopColor="#ef4444" stopOpacity={0}/></linearGradient>
                  <linearGradient id="transGrad" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stopColor="#f97316" stopOpacity={0.3}/><stop offset="100%" stopColor="#f97316" stopOpacity={0}/></linearGradient>
                  <linearGradient id="regGrad" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stopColor="#3b82f6" stopOpacity={0.3}/><stop offset="100%" stopColor="#3b82f6" stopOpacity={0}/></linearGradient>
                </defs>
                <CartesianGrid strokeDasharray="3 3" stroke="#1e293b" />
                <XAxis dataKey="month" tick={{fontSize:10,fill:'#64748b'}} axisLine={{stroke:'#1e293b'}} />
                <YAxis tick={{fontSize:10,fill:'#64748b'}} axisLine={{stroke:'#1e293b'}} />
                <RTooltip contentStyle={{background:'#1e293b',border:'1px solid #334155',borderRadius:'8px',fontSize:'11px',color:'#e2e8f0'}} />
                <Area type="monotone" dataKey="physical" stroke="#ef4444" fill="url(#physGrad)" strokeWidth={2} name="Physical Risk" />
                <Area type="monotone" dataKey="transition" stroke="#f97316" fill="url(#transGrad)" strokeWidth={2} name="Transition Risk" />
                <Area type="monotone" dataKey="regulatory" stroke="#3b82f6" fill="url(#regGrad)" strokeWidth={2} name="Regulatory" />
              </AreaChart>
            </ResponsiveContainer>
            <div style={{display:'flex',gap:'16px',marginTop:'8px',fontSize:'11px'}}>
              <span style={{display:'flex',alignItems:'center',gap:'4px'}}><span style={{width:'8px',height:'3px',background:'#ef4444',borderRadius:'2px',display:'inline-block'}}></span><span style={{color:'#94a3b8'}}>Physical</span></span>
              <span style={{display:'flex',alignItems:'center',gap:'4px'}}><span style={{width:'8px',height:'3px',background:'#f97316',borderRadius:'2px',display:'inline-block'}}></span><span style={{color:'#94a3b8'}}>Transition</span></span>
              <span style={{display:'flex',alignItems:'center',gap:'4px'}}><span style={{width:'8px',height:'3px',background:'#3b82f6',borderRadius:'2px',display:'inline-block'}}></span><span style={{color:'#94a3b8'}}>Regulatory</span></span>
            </div>
          </div>

          {/* Risk Matrix */}
          <div className="card">
            <div className="section-title">
              <span className="dot" style={{background:'#eab308'}}></span>
              Risk Assessment Matrix
            </div>
            <div className="risk-matrix">
              {/* Y-axis labels */}
              <div className="matrix-label y-axis" style={{gridRow:'1',gridColumn:'1',fontSize:'10px'}}>Catastrophic</div>
              <div className="matrix-label y-axis" style={{gridRow:'2',gridColumn:'1',fontSize:'10px'}}>Major</div>
              <div className="matrix-label y-axis" style={{gridRow:'3',gridColumn:'1',fontSize:'10px'}}>Moderate</div>
              <div className="matrix-label y-axis" style={{gridRow:'4',gridColumn:'1',fontSize:'10px'}}>Minor</div>
              <div className="matrix-label y-axis" style={{gridRow:'5',gridColumn:'1',fontSize:'10px'}}>Negligible</div>
              <div></div>
              {/* Matrix cells - rows from top (high impact) to bottom (low impact) */}
              {[4,3,2,1,0].map((y, yi) =>
                [0,1,2,3,4].map((x, xi) => {
                  const entry = RISK_MATRIX_DATA.find(d => d[0]===x && d[1]===y);
                  const count = entry ? entry[2] : 0;
                  return (
                    <div key={`${x}-${y}`} className={`matrix-cell sev-${matrixSeverity(x,y)}`}
                         style={{gridRow:yi+1, gridColumn:xi+2}}>
                      {count > 0 ? count : ''}
                    </div>
                  );
                })
              )}
              {/* X-axis labels */}
              <div></div>
              <div className="matrix-label" style={{fontSize:'10px'}}>Rare</div>
              <div className="matrix-label" style={{fontSize:'10px'}}>Unlikely</div>
              <div className="matrix-label" style={{fontSize:'10px'}}>Possible</div>
              <div className="matrix-label" style={{fontSize:'10px'}}>Likely</div>
              <div className="matrix-label" style={{fontSize:'10px'}}>Almost Certain</div>
            </div>
            <div style={{textAlign:'center',marginTop:'8px',fontSize:'10px',color:'#475569'}}>Likelihood →</div>
          </div>

          {/* Sector Exposure */}
          <div className="card">
            <div className="section-title">
              <span className="dot" style={{background:'#06b6d4'}}></span>
              Sector Risk Exposure
            </div>
            <ResponsiveContainer width="100%" height={180}>
              <PieChart>
                <Pie data={SECTOR_EXPOSURE} cx="50%" cy="50%" innerRadius={45} outerRadius={75} dataKey="value" nameKey="sector" strokeWidth={2} stroke="#111827">
                  {SECTOR_EXPOSURE.map((_, i) => <Cell key={i} fill={PIE_COLORS[i]} />)}
                </Pie>
                <RTooltip contentStyle={{background:'#1e293b',border:'1px solid #334155',borderRadius:'8px',fontSize:'11px',color:'#e2e8f0'}} />
              </PieChart>
            </ResponsiveContainer>
            <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'4px 12px',fontSize:'11px'}}>
              {SECTOR_EXPOSURE.map((s,i) => (
                <div key={i} style={{display:'flex',alignItems:'center',gap:'6px'}}>
                  <span style={{width:'8px',height:'8px',borderRadius:'2px',background:PIE_COLORS[i],flexShrink:0}}></span>
                  <span style={{color:'#94a3b8'}}>{s.sector}</span>
                  <span style={{color:'#e2e8f0',fontWeight:600,marginLeft:'auto'}}>{s.value}%</span>
                </div>
              ))}
            </div>
          </div>
        </div>
      </div>

      {/* Tooltip */}
      {tooltip && (
        <div className="tooltip" style={{left:tooltip.x,top:tooltip.y}}>
          <h5 style={{color:SEVERITY_COLORS[tooltip.incident.severity]}}>{tooltip.incident.type} — {tooltip.incident.severity.toUpperCase()}</h5>
          <p>{tooltip.incident.title}</p>
          <p style={{marginTop:'4px',color:'#64748b'}}>{tooltip.incident.region} · {tooltip.incident.date}</p>
          <p style={{marginTop:'2px',color:'#94a3b8',fontWeight:500}}>{tooltip.incident.impact}</p>
        </div>
      )}
    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<Dashboard />);
</script>
</body>
</html>
